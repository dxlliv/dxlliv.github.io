var S=Object.defineProperty;var L=(a,e,t)=>e in a?S(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var m=(a,e,t)=>L(a,typeof e!="symbol"?e+"":e,t);import{d as M,g as c,t as l,C as u,A as o,M as j,_ as k,z as _,P as D,r as x,aa as U,o as O,v as A,D as r,F as B,a8 as F,N as I,B as w,y as z,L as b,x as P,G as N,ab as W}from"./BZHdyvdd.js";import{u as K}from"./C3gJ1oef.js";const q=M({__name:"AgentMessage",props:{author:{}},setup(a){return(e,t)=>{const n=c("v-card");return l(),u(n,{class:"d-inline-block text-subtitle-2 px-4 py-3",color:e.author==="me"?"grey-lighten-2":"grey-lighten-4",rounded:"",flat:"","max-width":"70%"},{default:o(()=>[j(e.$slots,"default",{},void 0,!0)]),_:3},8,["color"])}}}),T=Object.assign(k(q,[["__scopeId","data-v-c0bf2b7f"]]),{__name:"AgentMessage"}),G={};function H(a,e){const t=c("v-progress-linear"),n=T;return l(),u(n,{author:"bot",width:56},{default:o(()=>[_(t,{indeterminate:"",color:"grey-lighten-2"})]),_:1})}const J=Object.assign(k(G,[["render",H]]),{__name:"AgentMessageWaiting"});class h{constructor(e,t){m(this,"chat",[]);m(this,"listElement");m(this,"agentBaseURL");m(this,"userId");m(this,"roomId");this.listElement=e,this.agentBaseURL=t,this.userId=h.generateID("xxxxxxx"),this.roomId=`room-${h.generateID("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx")}`}static generateID(e){return e.replace(/[xy]/g,t=>{const n=Math.random()*16|0;return(t==="x"?n:n&3|8).toString(16)})}scrollToBottom(){this.listElement.$el.scrollTop=this.listElement.$el.scrollHeight}addNewMessage(e,t){this.chat.push({author:e,text:t}),setTimeout(()=>{this.scrollToBottom()},25)}async sendMessage(e){const t={text:e,userId:this.userId,roomId:this.roomId},n=`${this.agentBaseURL}/message`;await fetch(n,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(t)}).then(s=>{if(!s.ok)throw new Error(`Request failed with status: ${s.status}`);return s.json()}).then(s=>{s.length>0&&this.addNewMessage("bot",s[0].text)}).catch(async()=>new Promise(s=>setTimeout(()=>{this.addNewMessage("bot","There was an error"),s(!0)},3e3)))}}const Q=D("agent",()=>{const a=x(null);function e(t,n){a.value||(a.value=new h(t,n))}return{agent:a,initialize:e}}),X=M({__name:"AgentForm",setup(a){const e=Q(),n=K().agent.baseURL,s=U("listElement"),d=x(!1);O(()=>{e.initialize(s,n)});const i=x("");async function f(){const v=String(i.value);i.value="",e.agent.addNewMessage("me",v),d.value=!0,await e.agent.sendMessage(v),d.value=!1}return(v,p)=>{const V=T,y=c("v-list-item"),$=J,C=c("v-list"),E=c("v-icon"),R=c("v-text-field");return l(),A(B,null,[r(e).agent?(l(),u(C,{key:0,ref_key:"listElement",ref:s,class:"mt-2",height:"50vh","max-height":400},{default:o(()=>[(l(!0),A(B,null,F(r(e).agent.chat,g=>(l(),u(y,{class:I(["py-1"])},{default:o(()=>[_(V,{author:g.author,class:I([{"float-right":g.author==="me"}])},{default:o(()=>[w(z(g.text),1)]),_:2},1032,["author","class"])]),_:2},1024))),256)),r(d)?(l(),u(y,{key:0,class:"py-1"},{default:o(()=>[_($)]),_:1})):b("",!0),r(e).agent.chat&&r(e).agent.chat.length===0?(l(),u(y,{key:1,class:"fill-height text-center"},{default:o(()=>p[1]||(p[1]=[w(" Let's talk about projects!"),P("br",null,null,-1),w(" What do you have in mind? ")])),_:1})):b("",!0)]),_:1},512)):b("",!0),_(R,{modelValue:r(i),"onUpdate:modelValue":p[0]||(p[0]=g=>N(i)?i.value=g:null),variant:"solo",flat:"","hide-details":"",autocomplete:"off",spellcheck:"false",readonly:r(d),placeholder:"Type a message",onKeydown:W(f,["enter"])},{prepend:o(()=>[_(E,{icon:"mdi-account-circle-outline",class:"ml-5 mr-n4"})]),_:1},8,["modelValue","readonly"])],64)}}}),Y=Object.assign(X,{__name:"AgentForm"}),Z=M({__name:"AgentDialog",props:{fullscreen:{type:Boolean}},setup(a){const e=x(!1);return(t,n)=>{const s=Y,d=c("v-card"),i=c("v-dialog");return l(),u(i,{activator:"parent",modelValue:r(e),"onUpdate:modelValue":n[0]||(n[0]=f=>N(e)?e.value=f:null),width:600,"max-width":"calc(100vw - 36px)",fullscreen:t.fullscreen,transition:"dialog-bottom-transition"},{default:o(()=>[_(d,{rounded:!t.fullscreen},{default:o(()=>[_(s)]),_:1},8,["rounded"])]),_:1},8,["modelValue","fullscreen"])}}}),se=Object.assign(Z,{__name:"AgentDialog"});export{se as _};
